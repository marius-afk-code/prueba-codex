{% extends "base.html" %}
{% block title %}Nuevo partido{% endblock %}

{% block content %}
  <h2>Nuevo partido</h2>
  <form method="post" class="card-form" id="match-form">
    <label for="date">Fecha (AAAA-MM-DD)</label>
    <input type="date" id="date" name="date" required />

    <label for="opponent">Rival</label>
    <input type="text" id="opponent" name="opponent" required />

    <div class="row-2">
      <div>
        <label for="goals_for">Goles a favor</label>
        <input type="number" id="goals_for" name="goals_for" min="0" required />
      </div>
      <div>
        <label for="goals_against">Goles en contra</label>
        <input type="number" id="goals_against" name="goals_against" min="0" required />
      </div>
    </div>

    <label for="notes_short">Notas cortas (opcional)</label>
    <textarea id="notes_short" name="notes_short" rows="2" placeholder="Ej: dominio territorial pero poca claridad final"></textarea>

    <h3>Registrar evento en campo realista</h3>
    <div class="event-controls row-3">
      <div>
        <label for="for_or_against">Tipo de gol</label>
        <select id="for_or_against">
          <option value="for">Gol a favor</option>
          <option value="against">Gol en contra</option>
        </select>
      </div>
      <div>
        <label for="minute">Minuto</label>
        <input type="number" id="minute" min="0" max="120" value="0" />
      </div>
      <div>
        <label for="play_type">Tipo de jugada</label>
        <select id="play_type">
          {% for play_type in play_types %}
            <option value="{{ play_type }}">{{ play_type }}</option>
          {% endfor %}
        </select>
      </div>
    </div>

    <div id="abp_subtype_wrap" class="abp-wrap hidden">
      <label for="abp_subtype">Subtipo ABP</label>
      <select id="abp_subtype">
        <option value="">Seleccionar subtipo ABP</option>
        {% for subtype in abp_subtypes %}
          <option value="{{ subtype }}">{{ subtype }}</option>
        {% endfor %}
      </select>
    </div>

    <div class="pitch-card">
      <div id="pitch" class="pitch" aria-label="Campo de fútbol clicable">
        <img src="{{ url_for('static', filename='img/pitch.svg') }}" alt="Campo de fútbol" class="pitch-img" />
        <div id="markers-layer" class="markers-layer"></div>
      </div>
      <p id="pitch-help" class="hint">Haz 1 clic para fijar la ubicación del evento.</p>
      <button type="button" class="btn" id="add-event-btn" disabled>Añadir evento</button>
    </div>

    <ul id="events-list" class="events-list"></ul>
    <input type="hidden" name="goal_events" id="goal_events" value="[]" />

    <button type="submit" class="btn">Guardar partido</button>
  </form>

  <script src="{{ url_for('static', filename='js/pitch.js') }}"></script>
{% endblock %}
